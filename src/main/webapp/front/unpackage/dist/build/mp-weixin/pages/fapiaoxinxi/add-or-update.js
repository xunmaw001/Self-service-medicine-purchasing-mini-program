(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/fapiaoxinxi/add-or-update"],{"55d0":function(e,a,n){"use strict";(function(e){Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var i=r(n("a34a"));function r(e){return e&&e.__esModule?e:{default:e}}function t(e,a,n,i,r,t,o){try{var u=e[t](o),s=u.value}catch(c){return void n(c)}u.done?a(s):Promise.resolve(s).then(i,r)}function o(e){return function(){var a=this,n=arguments;return new Promise((function(i,r){var o=e.apply(a,n);function u(e){t(o,i,r,u,s,"next",e)}function s(e){t(o,i,r,u,s,"throw",e)}u(void 0)}))}}var u=function(){Promise.all([n.e("common/vendor"),n.e("components/w-picker/w-picker")]).then(function(){return resolve(n("582c"))}.bind(null,n)).catch(n.oe)},s={data:function(){return{cross:"",ruleForm:{fapiaomingcheng:"",yaopinmingcheng:"",yaopinfenlei:"",goumaishuliang:"",goumaijine:"",fapiaoleixing:"",fapiaotupian:"",zhanghao:"",xingming:"",shoujihaoma:"",shibiehao:"",dizhi:"",shangjiazhanghao:"",shangjiamingcheng:"",kaipiaoriqi:"",userid:""},fapiaoleixingOptions:[],fapiaoleixingIndex:0,zhanghaoOptions:[],zhanghaoIndex:0,user:{},ro:{fapiaomingcheng:!1,yaopinmingcheng:!1,yaopinfenlei:!1,goumaishuliang:!1,goumaijine:!1,fapiaoleixing:!1,fapiaotupian:!1,zhanghao:!1,xingming:!1,shoujihaoma:!1,shibiehao:!1,dizhi:!1,shangjiazhanghao:!1,shangjiamingcheng:!1,kaipiaoriqi:!1,userid:!1}}},components:{wPicker:u},computed:{baseUrl:function(){return this.$base.url}},onLoad:function(a){var n=this;return o(i.default.mark((function r(){var t,o,u,s;return i.default.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return n.ruleForm.kaipiaoriqi=n.$utils.getCurDate(),t=e.getStorageSync("nowTable"),r.next=4,n.$api.session(t);case 4:return o=r.sent,n.user=o.data,n.fapiaoleixingOptions="普通发票,增值税发票".split(","),r.next=9,n.$api.option("yonghu","zhanghao",{});case 9:if(o=r.sent,n.zhanghaoOptions=o.data,n.ruleForm.userid=e.getStorageSync("userid"),a.refid&&(n.ruleForm.refid=a.refid,n.ruleForm.nickname=e.getStorageSync("nickname")),!a.id){r.next=19;break}return n.ruleForm.id=a.id,r.next=17,n.$api.info("fapiaoxinxi",n.ruleForm.id);case 17:o=r.sent,n.ruleForm=o.data;case 19:if(n.cross=a.cross,!a.cross){r.next=91;break}u=e.getStorageSync("crossObj"),r.t0=i.default.keys(u);case 23:if((r.t1=r.t0()).done){r.next=91;break}if(s=r.t1.value,"fapiaomingcheng"!=s){r.next=29;break}return n.ruleForm.fapiaomingcheng=u[s],n.ro.fapiaomingcheng=!0,r.abrupt("continue",23);case 29:if("yaopinmingcheng"!=s){r.next=33;break}return n.ruleForm.yaopinmingcheng=u[s],n.ro.yaopinmingcheng=!0,r.abrupt("continue",23);case 33:if("yaopinfenlei"!=s){r.next=37;break}return n.ruleForm.yaopinfenlei=u[s],n.ro.yaopinfenlei=!0,r.abrupt("continue",23);case 37:if("goumaishuliang"!=s){r.next=41;break}return n.ruleForm.goumaishuliang=u[s],n.ro.goumaishuliang=!0,r.abrupt("continue",23);case 41:if("goumaijine"!=s){r.next=45;break}return n.ruleForm.goumaijine=u[s],n.ro.goumaijine=!0,r.abrupt("continue",23);case 45:if("fapiaoleixing"!=s){r.next=49;break}return n.ruleForm.fapiaoleixing=u[s],n.ro.fapiaoleixing=!0,r.abrupt("continue",23);case 49:if("fapiaotupian"!=s){r.next=53;break}return n.ruleForm.fapiaotupian=u[s],n.ro.fapiaotupian=!0,r.abrupt("continue",23);case 53:if("zhanghao"!=s){r.next=57;break}return n.ruleForm.zhanghao=u[s],n.ro.zhanghao=!0,r.abrupt("continue",23);case 57:if("xingming"!=s){r.next=61;break}return n.ruleForm.xingming=u[s],n.ro.xingming=!0,r.abrupt("continue",23);case 61:if("shoujihaoma"!=s){r.next=65;break}return n.ruleForm.shoujihaoma=u[s],n.ro.shoujihaoma=!0,r.abrupt("continue",23);case 65:if("shibiehao"!=s){r.next=69;break}return n.ruleForm.shibiehao=u[s],n.ro.shibiehao=!0,r.abrupt("continue",23);case 69:if("dizhi"!=s){r.next=73;break}return n.ruleForm.dizhi=u[s],n.ro.dizhi=!0,r.abrupt("continue",23);case 73:if("shangjiazhanghao"!=s){r.next=77;break}return n.ruleForm.shangjiazhanghao=u[s],n.ro.shangjiazhanghao=!0,r.abrupt("continue",23);case 77:if("shangjiamingcheng"!=s){r.next=81;break}return n.ruleForm.shangjiamingcheng=u[s],n.ro.shangjiamingcheng=!0,r.abrupt("continue",23);case 81:if("kaipiaoriqi"!=s){r.next=85;break}return n.ruleForm.kaipiaoriqi=u[s],n.ro.kaipiaoriqi=!0,r.abrupt("continue",23);case 85:if("userid"!=s){r.next=89;break}return n.ruleForm.userid=u[s],n.ro.userid=!0,r.abrupt("continue",23);case 89:r.next=23;break;case 91:n.styleChange();case 92:case"end":return r.stop()}}),r)})))()},methods:{styleChange:function(){this.$nextTick((function(){}))},zhanghaoChange:function(e){var a=this;return o(i.default.mark((function n(){var r;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return a.zhanghaoIndex=e.target.value,a.ruleForm.zhanghao=a.zhanghaoOptions[a.zhanghaoIndex],n.next=4,a.$api.follow("yonghu","zhanghao",{columnValue:a.ruleForm.zhanghao});case 4:r=n.sent,r.data.xingming&&(a.ruleForm.xingming=r.data.xingming),r.data.shoujihaoma&&(a.ruleForm.shoujihaoma=r.data.shoujihaoma);case 7:case"end":return n.stop()}}),n)})))()},kaipiaoriqiChange:function(e){this.ruleForm.kaipiaoriqi=e.target.value,this.$forceUpdate()},fapiaoleixingChange:function(e){this.fapiaoleixingIndex=e.target.value,this.ruleForm.fapiaoleixing=this.fapiaoleixingOptions[this.fapiaoleixingIndex]},fapiaotupianTap:function(){var e=this;this.$api.upload((function(a){e.ruleForm.fapiaotupian="upload/"+a.file,e.$forceUpdate(),e.$nextTick((function(){e.styleChange()}))}))},getUUID:function(){return(new Date).getTime()},onSubmitTap:function(){var a=this;return o(i.default.mark((function n(){var r,t,o,u,s,c,g,l,f,h;return i.default.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(!a.ruleForm.goumaishuliang||a.$validate.isIntNumer(a.ruleForm.goumaishuliang)){n.next=3;break}return a.$utils.msg("购买数量应输入整数"),n.abrupt("return");case 3:if(!a.ruleForm.goumaijine||a.$validate.isIntNumer(a.ruleForm.goumaijine)){n.next=6;break}return a.$utils.msg("购买金额应输入整数"),n.abrupt("return");case 6:if(a.ruleForm.fapiaoleixing){n.next=9;break}return a.$utils.msg("发票类型不能为空"),n.abrupt("return");case 9:if(!a.cross){n.next=25;break}if(u=e.getStorageSync("statusColumnName"),s=e.getStorageSync("statusColumnValue"),""==u){n.next=25;break}if(c=e.getStorageSync("crossObj"),u.startsWith("[")){n.next=21;break}for(g in c)g==u&&(c[g]=s);return l=e.getStorageSync("crossTable"),n.next=19,a.$api.update("".concat(l),c);case 19:n.next=25;break;case 21:r=Number(e.getStorageSync("userid")),t=c["id"],o=e.getStorageSync("statusColumnName"),o=o.replace(/\[/,"").replace(/\]/,"");case 25:if(!t||!r){n.next=47;break}return a.ruleForm.crossuserid=r,a.ruleForm.crossrefid=t,f={page:1,limit:10,crossuserid:r,crossrefid:t},n.next=31,a.$api.list("fapiaoxinxi",f);case 31:if(h=n.sent,!(h.data.total>=o)){n.next=37;break}return a.$utils.msg(e.getStorageSync("tips")),n.abrupt("return",!1);case 37:if(!a.ruleForm.id){n.next=42;break}return n.next=40,a.$api.update("fapiaoxinxi",a.ruleForm);case 40:n.next=44;break;case 42:return n.next=44,a.$api.add("fapiaoxinxi",a.ruleForm);case 44:a.$utils.msgBack("提交成功");case 45:n.next=55;break;case 47:if(!a.ruleForm.id){n.next=52;break}return n.next=50,a.$api.update("fapiaoxinxi",a.ruleForm);case 50:n.next=54;break;case 52:return n.next=54,a.$api.add("fapiaoxinxi",a.ruleForm);case 54:a.$utils.msgBack("提交成功");case 55:case"end":return n.stop()}}),n)})))()},optionsChange:function(e){this.index=e.target.value},bindDateChange:function(e){this.date=e.target.value},getDate:function(e){var a=new Date,n=a.getFullYear(),i=a.getMonth()+1,r=a.getDate();return"start"===e?n-=60:"end"===e&&(n+=2),i=i>9?i:"0"+i,r=r>9?r:"0"+r,"".concat(n,"-").concat(i,"-").concat(r)},toggleTab:function(e){this.$refs[e].show()}}};a.default=s}).call(this,n("543d")["default"])},"5e473":function(e,a,n){},"77c5":function(e,a,n){"use strict";var i=n("5e473"),r=n.n(i);r.a},"86fb":function(e,a,n){"use strict";n.r(a);var i=n("55d0"),r=n.n(i);for(var t in i)"default"!==t&&function(e){n.d(a,e,(function(){return i[e]}))}(t);a["default"]=r.a},"95e4":function(e,a,n){"use strict";(function(e){n("7cd5");i(n("66fd"));var a=i(n("c727"));function i(e){return e&&e.__esModule?e:{default:e}}e(a.default)}).call(this,n("543d")["createPage"])},c727:function(e,a,n){"use strict";n.r(a);var i=n("f5e1"),r=n("86fb");for(var t in r)"default"!==t&&function(e){n.d(a,e,(function(){return r[e]}))}(t);n("77c5");var o,u=n("f0c5"),s=Object(u["a"])(r["default"],i["b"],i["c"],!1,null,"2ac5b3d6",null,!1,i["a"],o);a["default"]=s.exports},f5e1:function(e,a,n){"use strict";var i;n.d(a,"b",(function(){return r})),n.d(a,"c",(function(){return t})),n.d(a,"a",(function(){return i}));var r=function(){var e=this,a=e.$createElement;e._self._c},t=[]}},[["95e4","common/runtime","common/vendor"]]]);